%Timestep
X0 = zonotope([[0 ; 0], diag([0.0025 ; 0.05])]); % initial state zonotope
W = zonotope([0 ; 0], diag([0.1/2 ; 2.0/2])); % disturbance zonotope

%U = [-0.2252536666625929, -0.19384082815421272, -0.15717681148653808, -0.3627989317553775, -0.0256372518882528, -0.4572194323520806]; 
%6D soln
%dt = .18 18 timesteps (0.01)
%trange = 100, crange = 1

%U = [-0.1740740561040397, -0.14637469062083253, -0.0765546165213317, -0.16320591989919445, -0.04936249705520325, -0.24912735484764864, -0.09766393286586078, -0.34832362074431866, -0.11754171083775324, -0.37503388508807645];
%10D soln
%dt = .18 9 timesteps (0.02)
%trange = 100, crange = 1

%U = [-0.23494745790958405, -0.02182127721607685, -0.16249458491802216, -0.2089446485042572, -0.05227796733379364, -0.2302367240190506, -0.0850885808467865, -0.4463514983654022, -0.19928675889968872, -0.36301785707473755];
%U = [-0.2117, -0.1404, -0.0313, -0.1919, -0.0875, -0.2826, -0.0723, -0.3226, -0.0975, -0.3607]; %New method 10D soln
%U = [-0.191282719373703, -0.23996037244796753, -0.11708084493875504, -0.37329521775245667, -0.08216506987810135, -0.4117981195449829]; %new 6D soln
%-------------------------------------------------------------------------
%New solns
%U = [-0.1650179773569107, -0.21406877040863037, -0.12397558987140656, -0.37061041593551636, -0.10978655517101288, -0.4273490905761719]; %BES
%U = [-0.20740877091884613, -0.20480798184871674, -0.033390678465366364, -0.5579872727394104, -0.28607529401779175, -0.4019918739795685]; %ES
%U = [-0.1954134702682495, -0.051661111414432526, -0.4854508340358734, -0.6607547998428345, -0.11930514127016068, -0.267397403717041]; %PL
%U = [0,0,0,0,0,0];
%[-0.08519914001226425, -0.1582581251859665, -0.03854895383119583, -0.22881494462490082, -0.02544301003217697, -0.2835536003112793]
%U = [-0.0737, -0.1688, -0.0478, -0.2440, -0.0283, -0.2673];
U = [-0.09412188827991486, -0.15149283409118652, -0.05180063843727112, -0.22699208557605743, 0.005358181893825531, -0.2862488031387329];
trange = 100;
crange = 1;
N = length(U)/2;

inpt = [];
for i=1:N
    inpt = cat(1,inpt,[U(i*2-1)*trange/2,U(i*2)*crange/2]);
end

disp(inpt)

R = cstrgetTrueValueFG(U,trange,crange);

fig = figure();
ax = gca;
ax.FontSize = 14; 

hold on;

set(gcf,'color','white')
plot(R{1},[1 2],'Color','k','linewidth',3);
plot(R{2},[1 2],'Color','k','linewidth',3);
plot(R{3},[1 2],'Color','k','linewidth',3);
plot(R{4},[1 2],'Color','k','linewidth',3);
xlabel('C-C_0','FontSize',18);
ylabel('T-T_0','FontSize',18);


UA = 5e4;
npts = 100000;
dt = 0.18;

colors = {'b','g','c','y','r'};
mcpts = simulateMCPts(X0,dt,inpt,UA,npts);
scatter(mcpts(1,:),mcpts(2,:),['o' colors{1}])

mcpts2 = simulateMCPts(X0,dt,cat(2,zeros(N,1),inpt(:,2)),UA,npts);
scatter(mcpts2(1,:),mcpts2(2,:),['o' colors{2}])

mcpts3 = simulateMCPts(X0,dt,cat(2,inpt(:,1),zeros(N,1)),UA,npts);
scatter(mcpts3(1,:),mcpts3(2,:),['o' colors{3}])

mcpts4 = simulateMCPts(X0,dt,inpt,6e4,npts);
scatter(mcpts4(1,:),mcpts4(2,:),['o' colors{5}])
grid on
%legend('','','','','nominal','cooling fault','feed fault', 'fouling fault','Location','southwest')
ylim([-23,7])
xlim([-0.06,0.12])

export_fig 6DNoInStep3.pdf